Projeto Fase 4 - Pipeline de Treinamento e API

Visao geral
- Este repositorio tem duas partes principais: a pipeline de treinamento (com otimizacao via Optuna) e a API que publica o modelo para inferencia.
- A pipeline coleta a serie de precos, faz limpeza e normalizacao, treina um LSTM e salva checkpoints.
- A API FastAPI carrega um checkpoint e exp√µe um endpoint de previsao.

Estrutura de pastas
- pipeline: pipeline de treinamento e scripts de Optuna.
- api: servico FastAPI para inferencia do modelo.
- data: dados locais (se usados/gerados).
- checkpoints: checkpoints exportados para a API (montado no docker-compose).

Pipeline de treinamento (pipeline/)
- Entrada principal: `pipeline/main_train.py`.
- Passos principais:
  1) `data/1_source_yahoo.py` baixa a serie (yfinance).
  2) `preprocessing/1_integrity.py` limpa valores invalidos.
  3) `preprocessing/2_normalization.py` calcula media/desvio e normaliza.
  4) `training/1_train.py` treina o LSTM e salva checkpoint.
- O `TrainConfig` em `pipeline/config.py` centraliza hiperparametros e caminhos.

Checklist da pipeline (concluido)
- [x] Coleta de dados (Yahoo Finance).
- [x] Limpeza de dados (validacao de valores).
- [x] Normalizacao da serie.
- [x] Treinamento do modelo LSTM.
- [x] Salvamento de checkpoints.

Otimizacao com Optuna (pipeline/)
- Entrada principal: `pipeline/main_optuna.py`.
- A funcao `run_optuna_with_series` em `training/4_optuna_hpo.py` executa a busca.
- O estudo grava resultados no SQLite definido por `storage_path` no `TrainConfig`.
- O melhor checkpoint pode ser salvo como `best_pareto_lstm.pt`.

Checklist Optuna (concluido)
- [x] Definicao do estudo e espaco de busca.
- [x] Execucao de trials com pruner.
- [x] Registro de resultados em SQLite.
- [x] Exportacao do melhor checkpoint.

Inferencia local (pipeline/)
- Entrada principal: `pipeline/main_infer.py`.
- Carrega o checkpoint e executa `predict_next_from_values` com uma serie de floats.

API (api/)
- Entrada principal: `api/src/main_api.py`.
- Endpoint: `POST /predict`
  - body: `{ "values": [1.0, 2.0, ...], "checkpoint_path": "checkpoints/best.pt", "device": "cpu" }`
  - resposta: previsao e metadados do checkpoint.
- A API usa o modelo em `api/src/model/main_infer.py`.

Docker
- `docker-compose.yaml` sobe a API e monta `./checkpoints` em `/app/checkpoints`.
- O container expoe a porta 9010.

Como executar (exemplos)
- Pipeline treino:
  - `python -m pipeline.main_train`
- Optuna:
  - `python -m pipeline.main_optuna`
- API local:
  - `python -m src.main_api` (a partir de `api/`)
- API via Docker:
  - `docker compose up --build`
